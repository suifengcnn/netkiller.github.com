<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 2. Encode &amp; Decode</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="keywords" content="md5sum, openssl, openpgp, opengpg, md5, sha1, des, rsa, uuid, base64, quoted-printable, uuencode, x509,smime" /><link rel="home" href="../index.html" title="Netkiller Cryptography 手札" /><link rel="up" href="../index.html" title="Netkiller Cryptography 手札" /><link rel="prev" href="../uuid/linux.html" title="1.8. linux command uuid" /><link rel="next" href="uuencode.html" title="2.2. Uuencode" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/video.html">视频教程</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 2. Encode &amp; Decode</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../uuid/linux.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="uuencode.html">Next</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="index"></a>Chapter 2. Encode &amp; Decode</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#base64">2.1. MIME (BASE64) 专题</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp4">2.1.1. Linux Command base64</a></span></dt><dt><span class="section"><a href="index.html#base64.php">2.1.2. PHP Base64</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp5">2.1.2.1. base64_encode</a></span></dt><dt><span class="section"><a href="index.html#idp6">2.1.2.2. base64_decode</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#base64.python">2.1.3. Python Base64</a></span></dt><dt><span class="section"><a href="index.html#base64.perl">2.1.4. perl base64</a></span></dt><dt><span class="section"><a href="index.html#base64.java">2.1.5. Java Base64</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp7">2.1.5.1. Java 7</a></span></dt><dt><span class="section"><a href="index.html#idp8">2.1.5.2. Java 8</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#base64.c">2.1.6. C/C++ Base64</a></span></dt></dl></dd><dt><span class="section"><a href="uuencode.html">2.2. Uuencode</a></span></dt><dd><dl><dt><span class="section"><a href="uuencode.html#uuencode.php">2.2.1. PHP uuencode</a></span></dt></dl></dd><dt><span class="section"><a href="quoted-printable.html">2.3. Quoted-Printable</a></span></dt><dd><dl><dt><span class="section"><a href="quoted-printable.html#idp9">2.3.1. C Quoted-Printable</a></span></dt><dt><span class="section"><a href="quoted-printable.html#idp10">2.3.2. Java Quoted-Printable</a></span></dt><dt><span class="section"><a href="quoted-printable.html#idp11">2.3.3. Python Quoted-Printable</a></span></dt></dl></dd><dt><span class="section"><a href="base58.html">2.4. Base58</a></span></dt><dd><dl><dt><span class="section"><a href="base58.html#base58.php">2.4.1. php</a></span></dt><dt><span class="section"><a href="base58.html#base58.java">2.4.2. Java Base58</a></span></dt></dl></dd></dl></div>
	
	<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="base64"></a>2.1. MIME (BASE64) 专题</h2></div></div></div>
	
	<p><span class="emphasis"><em>什么是Base64？</em></span></p>
	<p>按照RFC2045的定义，Base64被定义为：Base64内容传送编码被设计用来把任意序列的8位字节描述为一种不易被人直接识别的形式。 </p>
	<p><span class="emphasis"><em>为什么要使用Base64？</em></span></p>
	<div class="orderedlist"><p class="title"><strong>在设计这个编码的时候，我想设计人员最主要考虑了3个问题：</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p>是否加密？</p></li><li class="listitem"><p>加密算法复杂程度和效率？</p></li><li class="listitem"><p>如何处理传输？</p></li></ol></div>
	<p>    加密是肯定的，但是加密的目的不是让用户发送非常安全的Email。这种加密方式主要就是“防君子不防小人”。即达到一眼望去完全看不出内容即可。
基于这个目的加密算法的复杂程度和效率也就不能太大和太低。和上一个理由类似，MIME协议等用于发送Email的协议解决的是如何收发Email，而并不是如何安全的收发Email。因此算法的复杂程度要小，效率要高，否则因为发送Email而大量占用资源，路就有点走歪了。</p>

	<p>    但是，如果是基于以上两点，那么我们使用最简单的恺撒法即可，为什么Base64看起来要比恺撒法复杂呢？这是因为在Email的传送过程中，由于历史原因，Email只被允许传送ASCII字符，即一个8位字节的低7位。因此，如果您发送了一封带有非ASCII字符（即字节的最高位是1）的Email通过有“历史问题”的网关时就可能会出现问题。网关可能会把最高位置为0！很明显，问题就这样产生了！因此，为了能够正常的传送Email，这个问题就必须考虑！所以，单单靠改变字母的位置的恺撒之类的方案也就不行了。关于这一点可以参考 RFC2046。
基于以上的一些主要原因产生了Base64编码。 </p>
	<p>参考邮件正文 Content-Transfer-Encoding: base64 </p>
	<a class="link" href="../">OpenSSL - Base64</a>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp4"></a>2.1.1. Linux Command base64</h3></div></div></div>
		
		<pre class="screen">
$ cat file | base64
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="base64.php"></a>2.1.2. PHP Base64</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp5"></a>2.1.2.1. base64_encode</h4></div></div></div>
			
			<p>base64_encode</p>
			<p>(PHP 3, PHP 4, PHP 5)</p>
			<p>base64_encode -- 使用 MIME base64 对数据进行编码</p>
			<p>说明</p>
			<p>string base64_encode ( string data )</p>
			<p>base64_encode() returns 使用 base64 对 data 进行编码。设计此种编码是为了使二进制数据可以通过非纯 8-bit 的传输层传输，例如电子邮件的主体。</p>
			<p>Base64-encoded 数据要比原始数据多占用 33% 左右的空间。 </p>
			<p>例子 1. base64_encode() 示例</p>
			<pre class="screen">
			
&lt;?php
  $str = 'This is an encoded string';
  echo base64_encode($str);
?&gt;
		
			</pre>
			<p>此示例将显示：</p>
			<p>VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw==</p>
			<p>例子 2. stream_filter_append() 示例</p>
			<pre class="screen">
			
&lt;?php
$fp = fopen('php://output', 'w');
stream_filter_append($fp, 'convert.base64-encode');
fwrite($fp, "This is a test.\n");
fclose($fp);
/* Outputs:  VGhpcyBpcyBhIHRlc3QuCg==  */
echo "\n============================================\n";

$fp = fopen('php://output', 'w');
stream_filter_append($fp, 'convert.base64-decode');
fwrite($fp, "VGhpcyBpcyBhIHRlc3QuCg==");
fclose($fp);
/* Outputs:  This is a test.  */
echo "============================================\n";

$param = array('line-length' =&gt; 8, 'line-break-chars' =&gt; "\r\n");
$fp = fopen('php://output', 'w');
stream_filter_append($fp, 'convert.base64-encode', STREAM_FILTER_WRITE, $param);
fwrite($fp, "This is a test.\n");
fclose($fp);
/* Outputs:  VGhpcyBp
         :  cyBhIHRl
         :  c3QuCg==  */
?&gt;
		
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp6"></a>2.1.2.2. base64_decode</h4></div></div></div>
			
			<p>base64_decode</p>
			<p>(PHP 3, PHP 4, PHP 5)</p>
			<p>base64_decode -- 对使用 MIME base64 编码的数据进行解码</p>
			<p>说明</p>
			<p>string base64_decode ( string encoded_data )</p>
			<p>base64_decode() 对 encoded_data 进行解码，返回原始数据，失败则返回 FALSE。返回的数据可能是二进制的。</p>
			<p>例子 1. base64_decode() 示例</p>
			<pre class="screen">
			
&lt;?php
$str = 'VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw==';
echo base64_decode($str);
?&gt;
			
			</pre>
			<p>此示例将显示：</p>
			<p>This is an encoded string</p>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="base64.python"></a>2.1.3. Python Base64</h3></div></div></div>
		
		<p>编码：b64encode</p>
			<pre class="screen">
			
import base64
base64.b64encode('This is an encoded string')
			
			</pre>
		<p>此示例将显示：</p>
		<p>'VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw=='</p>
		<p>解码：</p>
			<pre class="screen">
			
import base64
base64.b64decode('VGhpcyBpcyBhbiBlbmNvZGVkIHN0cmluZw==')
			
			</pre>
		<p>此示例将显示：</p>
		<p>This is an encoded string</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="base64.perl"></a>2.1.4. perl base64</h3></div></div></div>
		
		<pre class="screen">
perl -MMIME::Base64 -e 'print encode_base64("netkiller");'

perl -MMIME::Base64 -e 'print decode_base64("bmV0a2lsbGVy");'
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="base64.java"></a>2.1.5. Java Base64</h3></div></div></div>
		
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp7"></a>2.1.5.1. Java 7</h4></div></div></div>
			
			<pre class="screen">
import java.io.*;
public class base64Test {

	public static void main(String[] args) {

	    try {
	        String text = "This is an encoded string";
	        //Convert a string to base64 string
	        byte[] buf = text.getBytes();
	        String encode = new sun.misc.BASE64Encoder().encode(buf);
	        System.out.println(encode);

	        // Convert base64 string to a string
	        buf = new sun.misc.BASE64Decoder().decodeBuffer(encode);
	        String decode = new String(buf);
	        System.out.println(decode);
	    } catch (IOException e) {

	    }
	}
}
		</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp8"></a>2.1.5.2. Java 8</h4></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.test;

import java.nio.charset.StandardCharsets;
import java.util.Base64;

public class Base64Test {
	public static void main(String[] args) {
		final String text = "http://www.netkiller.cn/index.html";

		final String encoded = Base64.getEncoder().encodeToString(text.getBytes(StandardCharsets.UTF_8));
		System.out.println(encoded);

		final String decoded = new String(Base64.getDecoder().decode(encoded), StandardCharsets.UTF_8);
		System.out.println(decoded);
	}
}
			
			</pre>
			<pre class="programlisting">
			
package cn.netkiller.security;

import java.io.UnsupportedEncodingException;
import java.util.Base64;

public class Base64Test {

	public Base64Test() {
		// TODO Auto-generated constructor stub
	}

	public static void main(String[] args) throws UnsupportedEncodingException {
		// TODO Auto-generated method stub
		String asB64 = Base64.getEncoder().encodeToString("some string".getBytes("utf-8"));
		System.out.println(asB64); // 输出为: c29tZSBzdHJpbmc=

		// 解码
		byte[] asBytes = Base64.getDecoder().decode("c29tZSBzdHJpbmc=");
		System.out.println(new String(asBytes, "utf-8")); // 输出为: some string

		// 但由于URL对反斜线“/”有特殊的意义，因此URL编码需要替换掉它，使用下划线替换
		String basicEncoded = Base64.getEncoder().encodeToString("subjects?abcd".getBytes("utf-8"));
		System.out.println("Using Basic Alphabet: " + basicEncoded);

		String urlEncoded = Base64.getUrlEncoder().encodeToString("subjects?abcd".getBytes("utf-8"));
		System.out.println("Using URL Alphabet: " + urlEncoded);
	}

}

			
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="base64.c"></a>2.1.6. C/C++ Base64</h3></div></div></div>
		
		<p></p>
	</div>
</div>
	

	

	
</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../uuid/linux.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="uuencode.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.8. linux command uuid </td><td width="20%" align="center"><a accesskey="h" href="../index.html">Home</a></td><td width="40%" align="right" valign="top"> 2.2. Uuencode</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script></body></html>