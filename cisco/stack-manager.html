<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.10. stack-manager</title><link rel="stylesheet" type="text/css" href="/docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="keywords" content="pix,asa,3750,4507,5550, vlan,vtp, hsrp,vrrp, rip,ospf" /><link rel="home" href="index.html" title="Netkiller Cisco IOS 手札" /><link rel="up" href="switch.html" title="第 6 章 Switch" /><link rel="prev" href="switch.speed.html" title="6.9. 流量控制" /><link rel="next" href="switch.hsrp.html" title="6.11. HSRP(Hot Standby Router Protocol)" /></head><body><a xmlns="" href="http://www.netkiller.cn/">Home</a> |
		<a xmlns="" href="http://netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="/search.html">Search</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.10. stack-manager</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="switch.speed.html">上一页</a> </td><th width="60%" align="center">第 6 章 Switch</th><td width="20%" align="right"> <a accesskey="n" href="switch.hsrp.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="stack-manager"></a>6.10. stack-manager</h2></div></div></div>
		
		<pre class="screen">
察看当前堆叠状态：
show platform stack-manager all 显示所有交换堆叠的信息
show switch 显示堆叠交换机的汇总信息
show switch 1 显示一号交换机的信息
show switch detail 显示堆叠成员明细的信息
show switch neighbors 显示堆叠邻居的完整信息
show switch stack-ports 显示堆叠交换机的完整端口信息
		</pre>
		<pre class="screen">
3750#show platform stack-manager all
Switch/Stack Mac Address : aca0.165f.9800
                                           H/W   Current
Switch#  Role   Mac Address     Priority Version  State
----------------------------------------------------------
 1       Member 0000.0000.0000     0      0       Provisioned
 2       Member 40f4.ec3c.6780     1      0       Ready
*3       Master aca0.165f.9800     1      0       Ready



         Stack Port Status             Neighbors
Switch#  Port 1     Port 2           Port 1   Port 2
--------------------------------------------------------
  2        Ok         Ok                3        3
  3        Ok         Ok                2        2


               Stack Discovery Protocol View
==============================================================


Switch   Active   Role    Current   Sequence   Dirty
Number                    State     Number     Bit
--------------------------------------------------------------------
2        TRUE    Member   Ready       055       FALSE
3        TRUE    Master   Ready       055       FALSE



                 Stack State Machine View
==============================================================

Switch   Master/   Mac Address          Version    Current
Number   Member                          (maj.min)  State
-----------------------------------------------------------
2        Member    40f4.ec3c.6780          1.34        Ready
3        Master    aca0.165f.9800          1.34        Ready

Last Conflict Parameters

Switch Master/ Cfgd Default Image H/W  # of    Mac Address
Number Member  Prio Config   Type Prio Members
-----------------------------------------------------------------------

            Stack Discovery Protocol Counters
        Messages Sent                  Messages Recvd
        UP       DOWN                  UP        DOWN
--------------------------------------------------------
 1: 0000000000 0000000000          0000000000 0000000000
 2: 0000004122 0000004114          0000004906 0000004892
*3: 0000006311 0000006321          0000004121 0000004113
 4: 0000000000 0000000000          0000000000 0000000000
 5: 0000000000 0000000000          0000000000 0000000000
 6: 0000000000 0000000000          0000000000 0000000000
 7: 0000000000 0000000000          0000000000 0000000000
 8: 0000000000 0000000000          0000000000 0000000000
 9: 0000000000 0000000000          0000000000 0000000000

Stack Changes: 11
Internal Stack Link changes: 0
Internal Stack Link state: 0x0
Sync Not OK Resets A: 624  B: 618

             Misc  Counters
   Counter                      Up          Down
---------------------------------------------------

 Wrong Ver Number: Send:    0000000000    0000000000
 Wrong Ver Number: Recv:    0000000000    0000000000
 Missed Messages:           0000000000    0000000000
 Orphaned Messages          0000000000    0000000000
 Supressed Messages         0000000784    0000000778
 No Available Messages      0000006660    0000006660
 Link Present               0000000003    0000000007
 Link Not Present           0000000003    0000000007
 Link RxReset               0000000013    0000000014
 RAC Not OK Resets: 0
 Duplicates:                0000001434    0000001425
 Switch Number of last duplicate:     2
 Sequence Number Failures:     0000000000
 Switch Number of last Failure:     256  Last Difference 0
 Reciprocal Efficiency Changes: Upgrade 0  Downgrade 0
 Switch Number Conflicts: 0

             Resource Counters
-------------------------------------------
 Chunk Alloc's        0000000006
 Chunk Free's         0000000005
 Enqueue Failures:    0000000000
 Null Queue Failures: 0000000000
 Chunk Alloc Errors:  0000000000


           Stack State Machine Counters
   Messages Sent              Messages Recvd
-------------------------------------------------
 1: 0000000000                 0000000000
 2: 0000000006                 0000000006
*3: 0000000000                 0000000000
 4: 0000000000                 0000000000
 5: 0000000000                 0000000000
 6: 0000000000                 0000000000
 7: 0000000000                 0000000000
 8: 0000000000                 0000000000
 9: 0000000000                 0000000000

3750#show switch
Switch/Stack Mac Address : aca0.165f.9800
                                           H/W   Current
Switch#  Role   Mac Address     Priority Version  State
----------------------------------------------------------
 1       Member 0000.0000.0000     0      0       Provisioned
 2       Member 40f4.ec3c.6780     1      0       Ready
*3       Master aca0.165f.9800     1      0       Ready



3750#show switch 1
Switch/Stack Mac Address : aca0.165f.9800
                                           H/W   Current
Switch#  Role   Mac Address     Priority Version  State
----------------------------------------------------------
 1       Member 0000.0000.0000     0      0       Provisioned



3750#show switch detail
Switch/Stack Mac Address : aca0.165f.9800
                                           H/W   Current
Switch#  Role   Mac Address     Priority Version  State
----------------------------------------------------------
 1       Member 0000.0000.0000     0      0       Provisioned
 2       Member 40f4.ec3c.6780     1      0       Ready
*3       Master aca0.165f.9800     1      0       Ready



         Stack Port Status             Neighbors
Switch#  Port 1     Port 2           Port 1   Port 2
--------------------------------------------------------
  2        Ok         Ok                3        3
  3        Ok         Ok                2        2

3750#show switch neighbors
  Switch #    Port 1       Port 2
  --------    ------       ------
      2         3             3
      3         2             2

3750#show switch stack-ports
  Switch #    Port 1       Port 2
  --------    ------       ------
    2           Ok           Ok
    3           Ok           Ok

		</pre>
		<p>更改设备在堆叠中的编号</p>
		<pre class="screen">
switch 5 renumber 4 	把5号改为4号
switch 1 priority 2 	(1号设备的优先改为2) 默认优先级是1
		</pre>
		<p>更改优先级命令 </p>
		<pre class="screen">
更改优先级步骤：
switch 1 priority 2 (1号设备的优先改为2)
end
reload slot 1 （调用配置变更）
show switch 1 （察看1号设备的成员信息）
		</pre>

		<p>强制指定Master设备</p>
		<p>在主堆叠交换机上设置顺序</p>
		<pre class="screen">
		
cluster member 1 mac-address &lt;第一个堆叠交换机的mac&gt;
cluster member 2 mac-address &lt;第二个堆叠交换机的mac&gt;
		
		</pre>
		<p>在各个堆叠交换机上使用下面的命令： </p>
		<pre class="screen">
		
cluster command-address &lt;主交换机的mac&gt;
   		
		</pre>
	</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="switch.speed.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="switch.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="switch.hsrp.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6.9. 流量控制 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.11. HSRP(Hot Standby Router Protocol)</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>