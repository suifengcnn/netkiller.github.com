<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 5 章 File Share</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="keywords" content="openfiler, freenas, proftpd,pureftpd,vsftpd, rsync,wget,samba" /><link rel="home" href="../index.html" title="Netkiller Linux Storage 手札" /><link rel="up" href="../index.html" title="Netkiller Linux Storage 手札" /><link rel="prev" href="../synchronize/synctool.html" title="4.6. synctool" /><link rel="next" href="pnfs.html" title="5.2. Parallel NFS(pNFS)" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/video.html">视频教程</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 5 章 File Share</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../synchronize/synctool.html">上一页</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="pnfs.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="index"></a>第 5 章 File Share</h1></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#nfs">5.1. NFSv4</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#ubuntu">5.1.1. Ubuntu</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#nfs.server">5.1.1.1. NFSv4 server</a></span></dt><dt><span class="section"><a href="index.html#nfs.client">5.1.1.2. NFSv4 client</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#centos">5.1.2. CentOS</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#nfs.server">5.1.2.1. NFS Server Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp61">5.1.2.1.1. NFS 防火墙配置</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#nfs.client">5.1.2.2. NFS Client Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp62">5.1.2.2.1. Using NFS over UDP</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="index.html#nfs.exports">5.1.3. exports</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp63">5.1.3.1. Permission</a></span></dt><dt><span class="section"><a href="index.html#idp64">5.1.3.2. Parameters</a></span></dt><dt><span class="section"><a href="index.html#idp65">5.1.3.3. 实例参考</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#nfs.windowns">5.1.4. NFS For Windows</a></span></dt><dt><span class="section"><a href="index.html#exportfs">5.1.5. exportfs - maintain table of exported NFS file systems</a></span></dt></dl></dd><dt><span class="section"><a href="pnfs.html">5.2. Parallel NFS(pNFS)</a></span></dt><dt><span class="section"><a href="samba.html">5.3. Samba</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#install">5.3.1. install</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#idp66">5.3.1.1. Ubuntu</a></span></dt><dt><span class="section"><a href="samba.html#centos6">5.3.1.2. Samba</a></span></dt><dt><span class="section"><a href="samba.html#centos7">5.3.1.3. CentOS 7</a></span></dt><dt><span class="section"><a href="samba.html#samba.firewall">5.3.1.4. firewall</a></span></dt><dt><span class="section"><a href="samba.html#samba.SELinux">5.3.1.5. SELinux Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="samba.html#smb.conf">5.3.2. smb.conf</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#idp67">5.3.2.1. Security consideration</a></span></dt></dl></dd><dt><span class="section"><a href="samba.html#testparm">5.3.3. testparm - check an smb.conf configuration file for internal correctness</a></span></dt><dt><span class="section"><a href="samba.html#smbstatus">5.3.4. smbstatus - report on current Samba connections</a></span></dt><dt><span class="section"><a href="samba.html#smbpasswd">5.3.5. smbpasswd - change a user's SMB password</a></span></dt><dt><span class="section"><a href="samba.html#nmblookup">5.3.6. nmblookup - NetBIOS over TCP/IP client used to lookup NetBIOS names</a></span></dt><dt><span class="section"><a href="samba.html#smbfs">5.3.7. smbfs/smbmount/smbumount</a></span></dt><dt><span class="section"><a href="samba.html#smbclient">5.3.8. smbclient - ftp-like client to access SMB/CIFS resources on servers</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#idp68">5.3.8.1. 显示共享目录</a></span></dt><dt><span class="section"><a href="samba.html#idp69">5.3.8.2. 访问共享资源</a></span></dt><dt><span class="section"><a href="samba.html#idp70">5.3.8.3. 用户登录</a></span></dt></dl></dd><dt><span class="section"><a href="samba.html#smbtar">5.3.9. smbtar - shell script for backing up SMB/CIFS shares directly to UNIX tape drives</a></span></dt><dt><span class="section"><a href="samba.html#example">5.3.10. by Example</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#idp71">5.3.10.1. share</a></span></dt><dt><span class="section"><a href="samba.html#idp72">5.3.10.2. user</a></span></dt><dt><span class="section"><a href="samba.html#idp73">5.3.10.3. test</a></span></dt></dl></dd><dt><span class="section"><a href="samba.html#faq">5.3.11. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="samba.html#idp74">5.3.11.1. smbd/service.c:make_connection_snum(1013)</a></span></dt></dl></dd></dl></dd></dl></div>
	
	

<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="nfs"></a>5.1. NFSv4</h2></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ubuntu"></a>5.1.1. Ubuntu</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="nfs.server"></a>5.1.1.1. NFSv4 server</h4></div></div></div>
			
			<pre class="screen">
sudo apt-get install nfs-kernel-server
			</pre>
			<p>Configuration</p>
			<pre class="screen">
vim /etc/exports
/www	 *(ro,sync,no_root_squash)
/home    *(rw,sync,no_root_squash)
/export       192.168.1.0/24(rw,fsid=0,insecure,no_subtree_check,async)
/export/users 192.168.1.0/24(rw,nohide,insecure,no_subtree_check,async)
			</pre>
			<p>To start the NFS server</p>
			<pre class="screen">
sudo /etc/init.d/nfs-kernel-server start
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="nfs.client"></a>5.1.1.2. NFSv4 client</h4></div></div></div>
			
			<pre class="screen">
sudo apt-get install nfs-common
			</pre>
			<p>NFSv3</p>
			<pre class="screen">
sudo mount example.hostname.com:/www /www
			</pre>
			<p>NFSv4</p>
			<pre class="screen">
# mount -t nfs4 -o proto=tcp,port=2049 nfs-server:/ /mnt
# mount -t nfs4 -o proto=tcp,port=2049 nfs-server:/users /home/users
			</pre>
			<p>NFS Client Configuration</p>
			<pre class="screen">
vim /etc/fstab
example.hostname.com:/ubuntu /local/ubuntu nfs rsize=8192,wsize=8192,timeo=14,intr
			</pre>
		</div>
	</div>
	
	
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="centos"></a>5.1.2. CentOS</h3></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="nfs.server"></a>5.1.2.1. NFS Server Configuration</h4></div></div></div>
		
		<pre class="screen">
yum install -y nfs-utils
		</pre>
		<div class="procedure"><a id="idp135"></a><p class="title"><strong>过程 5.1. On the *SERVER* side</strong></p><ol class="procedure" type="1"><li class="step">
				<p>stop &amp; disable services</p>
				<pre class="screen">
service nfs stop
service nfslock stop
service rpcbind stop
service rpcidmapd stop
				</pre>
			</li><li class="step">
				<p>/etc/fstab</p>
				<pre class="screen">
as root edit /etc/fstab and add nfs4 exports

/www  /exports    none    bind    0 0
				</pre>
			</li><li class="step">
				<p>as root edit /etc/exports</p>
				<p>NFSv3</p>
				<pre class="screen">
/exports 		172.16.1.0/24 (rw,sync)
				</pre>
				<p>NFSv4</p>
				<pre class="screen">
/exports 		172.16.1.0/24(rw,sync,fsid=0,anonuid=99,anongid=99)
/exports/neo	*(rs,sync)
				</pre>
			</li><li class="step">
				<p>reload exported filesystems</p>
				<pre class="screen">
# exportfs -rv
				</pre>
			</li><li class="step">
				<p>start required services</p>
				<pre class="screen">
chkconfig rpcbind on
chkconfig nfs on
chkconfig nfslock on
chkconfig rpcidmapd on

service rpcbind start
service rpcidmapd start
service nfs start
service nfslock start
				</pre>
			</li><li class="step">
				<p>nfs status</p>
				<pre class="screen">
#  nfsstat
Server rpc stats:
calls      badcalls   badauth    badclnt    xdrcall
171        0          0          0          0

Server nfs v3:
null         getattr      setattr      lookup       access       readlink
3         1% 150      88% 0         0% 3         1% 2         1% 0         0%
read         write        create       mkdir        symlink      mknod
0         0% 0         0% 0         0% 0         0% 0         0% 0         0%
remove       rmdir        rename       link         readdir      readdirplus
0         0% 0         0% 0         0% 0         0% 0         0% 9         5%
fsstat       fsinfo       pathconf     commit
0         0% 3         1% 0         0% 0         0%
				</pre>
				<pre class="screen">
# watch nfsstat -c

Every 2.0s: nfsstat -c                                                                                                                          Mon Sep 20 16:53:55 2010

Client rpc stats:
calls      retrans    authrefrsh
286818929   1160       0

Client nfs v4:
null         read         write        commit       open         open_conf
0         0% 37286763 13% 6         0% 1         0% 38990106 13% 17986485  6%
open_noat    open_dgrd    close        setattr      fsinfo       renew
6         0% 0         0% 38774539 13% 2172019   0% 16        0% 147       0%
setclntid    confirm      lock         lockt        locku        access
321       0% 321       0% 0         0% 0         0% 0         0% 62157123 21%
getattr      lookup       lookup_root  remove       rename       link
80553542 28% 8828991   3% 8         0% 5         0% 5         0% 0         0%
symlink      create       pathconf     statfs       readlink     readdir
0         0% 1         0% 0         0% 5         0% 0         0% 13933     0%
server_caps  delegreturn
24        0% 54556     0%
				</pre>
			</li><li class="step">
				<p>security</p>
				<pre class="screen">
# vi /etc/hosts.deny
rpcbind:ALL

# vi /etc/hosts.allow
rpcbind:172.16.1.0/255.255.254.0
				</pre>
			</li></ol></div>
		<p>NFS的队列大小下面将设置为较合理的值256K</p>
		<pre class="screen">
# echo 262144 &gt; /proc/sys/net/core/rmem_default
# echo 262144 &gt; /proc/sys/net/core/rmem_max
# echo 262144 &gt; /proc/sys/net/core/wmmen_default
# echo 262144 &gt; /proc/sys/net/core/wmmen_max
		</pre>
		<div class="procedure"><a id="idp136"></a><p class="title"><strong>过程 5.2. NFSv4</strong></p><ol class="procedure" type="1"><li class="step">
				<p>/etc/exports</p>
				<pre class="screen">
# cat /etc/exports
/www		172.16.1.2/32(ro,sync,fsid=0,anonuid=99,anongid=99)
/www/logs	*(rw,sync)
				</pre>
				<p>注意，要通过NFS4共享一个目录,必须使用 fsid=0 的参数,使用fsid=0选项的时候只能共享一个目录，这个目录将成为NFS服务器的根目录。</p>
			</li><li class="step">
				<p>启动NFS,v4 不需要rpcbind</p>
				<pre class="screen">
service rpcbind stop
service rpcidmapd stop
service nfs restart
service nfslock stop
				</pre>
			</li><li class="step">
				<p>查看 export 设置</p>
				<pre class="screen">
# exportfs
/www          	172.16.1.2/32
/www/logs     	172.16.1.0/24
				</pre>
			</li><li class="step">
				<p>mount NFSv4</p>
				<pre class="screen">
mount -t nfs4 172.16.1.15:/logs /mnt
				</pre>
			</li></ol></div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp61"></a>5.1.2.1.1. NFS 防火墙配置</h5></div></div></div>
			
			<p>查看NFS正在使用的端口</p>
			<pre class="screen">
rpcinfo -p localhost			
			</pre>
			<p>vi /etc/sysconfig/nfs</p>
			<pre class="screen">
LOCKD_TCPPORT=32803
LOCKD_UDPPORT=32769
MOUNTD_PORT=892
RQUOTAD_PORT=875
STATD_PORT=662
STATD_OUTGOING_PORT=2020
			</pre>
			<pre class="screen">
service nfs restart
			</pre>
			<pre class="screen">
iptables -I INPUT -m state --state NEW -p tcp \
    -m multiport --dport 111,892,2049,32803 -s 192.168.0.0/24 -j ACCEPT
 
iptables -I INPUT -m state --state NEW -p udp \
    -m multiport --dport 111,892,2049,32769 -s 192.168.0.0/24 -j ACCEPT		
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="nfs.client"></a>5.1.2.2. NFS Client Configuration</h4></div></div></div>
		
		<p>CentOS 6 NFSv3 portmap 已经不存,已经被rpcbind替代</p>
		<pre class="screen">
chkconfig rpcbind on
service rpcbind start
		</pre>
		<p>test nfs</p>
			<pre class="screen">
mount 172.16.1.10:/exports /mnt
			</pre>
		<p>NFSv4</p>
		<pre class="screen">
mount -t nfs4 -o ro,intr 172.16.1.10:/ /mnt
		</pre>
		<pre class="screen">
umount /mnt
		</pre>
		<div class="procedure"><a id="idp137"></a><p class="title"><strong>过程 5.3. On the *CLIENT* side</strong></p><ol class="procedure" type="1"><li class="step">
				<p>Mounting NFS File Systems using /etc/fstab</p>
				<p>The general syntax for the line in /etc/fstab is as follows:</p>
				<pre class="screen">
server:/usr/local/pub    /pub   nfs    rsize=8192,wsize=8192,timeo=14,intr
				</pre>
				<p>NFSv4</p>
				<pre class="screen">
server:/ /mount/point nfs4 rw,hard,intr,proto=tcp,port=2049,auto 0 0
				</pre>
			</li><li class="step">
				<p>mount all stuff from /etc/fstab</p>
				<pre class="screen">
# mount -a
				</pre>
			</li><li class="step">
				<p>rpcinfo</p>
				<pre class="screen">
rpcinfo -p
   program vers proto   port
    100000    2   tcp    111  portmapper
    100000    2   udp    111  portmapper
    100024    1   udp    707  status
    100024    1   tcp    710  status
    100021    1   udp  48233  nlockmgr
    100021    3   udp  48233  nlockmgr
    100021    4   udp  48233  nlockmgr
    100021    1   tcp  58065  nlockmgr
    100021    3   tcp  58065  nlockmgr
    100021    4   tcp  58065  nlockmgr
				</pre>
			</li><li class="step">
				<p>start required services</p>
				<p>centos 5.x</p>
				<pre class="screen">
chkconfig portmap on
service portmap start
				</pre>
				<p>centos 6</p>
				<pre class="screen">
chkconfig rpcbind on
service rpcbind start
				</pre>
			</li></ol></div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp62"></a>5.1.2.2.1. Using NFS over UDP</h5></div></div></div>
			
			<p>For example, on demand via the command line (client side):</p>
			<pre class="screen">
mount -o udp shadowman.example.com:/misc/export /misc/local
			</pre>
			<p>When the NFS mount is specified in /etc/fstab (client side):</p>
			<pre class="screen">
server:/usr/local/pub    /pub   nfs    rsize=8192,wsize=8192,timeo=14,intr,udp
			</pre>
		</div>
	</div>
	
</div>	
	
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="nfs.exports"></a>5.1.3. exports</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp63"></a>5.1.3.1. Permission</h4></div></div></div>
			
			<pre class="screen">
/etc/exports为：

/tmp　　　　　*(rw,no_root_squash)

/home/public　192.168.0.*(rw)　　 *(ro)

/home/test　　192.168.0.100(rw)

/home/linux　 *.example.com(rw,all_squash,anonuid=40,anongid=40)
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp64"></a>5.1.3.2. Parameters</h4></div></div></div>
			
			<p>General Options</p>
			<pre class="screen">
ro                      只读访问
rw                      读写访问
rsize					同时传输(读 )的数据块大小
wsize					同时传输(写)的数据块大小

sync                    所有数据在请求时写入共享
async                   NFS在写入数据前可以相应请求

secure                  NFS通过1024以下的安全TCP/IP端口发送
insecure                NFS通过1024以上的端口发送
wdelay                  如果多个用户要写入NFS目录，则归组写入（默认）
no_wdelay               如果多个用户要写入NFS目录，则立即写入，当使用async时，无需此设置。
hide                    在NFS共享目录中不共享其子目录
no_hide                 共享NFS目录的子目录
subtree_check           如果共享/usr/bin之类的子目录时，强制NFS检查父目录的权限（默认）
no_subtree_check        和上面相对，不检查父目录权限
			</pre>
			<p>User ID Mapping</p>
			<pre class="screen">
all_squash              共享文件的UID和GID映射匿名用户anonymous，适合公用目录。
no_all_squash           保留共享文件的UID和GID（默认）
root_squash             root用户的所有请求映射成如anonymous用户一样的权限（默认）
no_root_squas           root用户具有根目录的完全管理访问权限
anonuid=xxx             指定NFS服务器/etc/passwd文件中匿名用户的UID
anongid=xxx             指定NFS服务器/etc/passwd文件中匿名用户的GID
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp65"></a>5.1.3.3. 实例参考</h4></div></div></div>
			
			<p>只读挂载</p>
			<pre class="screen">
172.16.2.5:/   /www/images   nfs4       ro,rsize=8192,wsize=8192,timeo=15,intr,noac
			</pre>
		</div>
	</div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="nfs.windowns"></a>5.1.4. NFS For Windows</h3></div></div></div>
		
		<p>安装NFS服务，进入“控制面板”，点击“打开或关闭Windows功能”，再勾选“NFS 服务”，最后确定</p>
		<p>启动NFS服务，控制面板\管理工具\Network File System 服务(NFS)</p>
		<p>或者通过命令启动NFS服务</p>
		<pre class="screen">
nfsadmin client [ComputerName] start
		</pre>
		<p>指定挂在用户ID，开始“运行”输入“regedit”回车，然后找到 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ClientForNFS\CurrentVersion\Default，右键“新建”选择“DWORD(32为)值” 添加 AnonymousUid，AnonymousGid，然后双击 AnonymousUid，AnonymousGid编辑，选择十进制并输入用户ID。</p>
		<p>重新启动NFS 服务，不需要重新启动计算机。</p>
		<p>挂载文件系统</p>
		<pre class="screen">
		
C:\Users\neo&gt;mount \\192.168.2.15\www x:\
		
		</pre>
		<p>卸载文件系统</p>
		<pre class="screen">
		
C:\Users\neo&gt;umount x:

正在断开                x:      \\192.168.2.15\www
连接上存在打开的文件和/或未完成的目录搜索。

要继续此操作吗? (Y/N) [N]:Y

命令已成功完成。
		
		</pre>
		<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[提示]" src="/graphics/tip.png" /></td><th align="left">提示</th></tr><tr><td align="left" valign="top">
			<p>很不幸Microsoft Windows 目前尚不支持UTF-8字符集。</p>
		</td></tr></table></div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="exportfs"></a>5.1.5. exportfs - maintain table of exported NFS file systems</h3></div></div></div>
		
		<pre class="screen">
# exportfs -o rw,all_squash,sync,anonuid=500,anongid=500 172.16.0.0/24:/www
# exportfs
/www          	172.16.0.0/24

# cat /var/lib/nfs/etab
/www	172.16.0.0/24(rw,sync,wdelay,hide,nocrossmnt,secure,root_squash,all_squash,no_subtree_check,secure_locks,acl,anonuid=500,anongid=500)
		</pre>

		<p>reload /etc/exports</p>
		<pre class="screen">
/usr/sbin/exportfs -r
		</pre>
		<p>To unexport the /usr/tmp directory:</p>
		<pre class="screen">
# exportfs -u netkiller.github.com:/usr/tmp
		</pre>
		<p>To unexport all exports listed in /etc/exports:</p>
		<pre class="screen">
# exportfs -au
		</pre>
		<pre class="screen">
#!/bin/bash
RETVAL=0

start()
{
	/usr/sbin/exportfs -o rw,all_squash,sync,anonuid=500,anongid=500 172.16.0.0/24:/backup
	mount /dev/sdb1 /backup
	RETVAL=$?
	echo
}

stop()
{
	exportfs -u 172.16.0.0/24:/backup
	umount /backup
	RETVAL=$?
}


		</pre>
	</div>
</div>

	


</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../synchronize/synctool.html">上一页</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="pnfs.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">4.6. synctool </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 5.2. Parallel NFS(pNFS)</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>